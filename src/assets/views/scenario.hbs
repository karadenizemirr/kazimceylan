<!--====== Solutions Section Start ======-->
<section class="solutions-section-two rel z-1 pt-130 rpt-100 pb-80 rpb-50">
    <div class="container">
        <div class="card p-3 shadow">
            <div class="card-title text-center">
                <h3>
                    Senaryo Oluştur
                </h3>
            </div>
            <div class="card-body">
                <form id="scenario_form">
                    <div class="row">
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Şirket & Şahıs İsmi" name="company_name"
                                autocomplete="off" value="{{briefs.company_name}}">
                        </div>
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Hizmet & Ürün" name="product"
                                autocomplete="off" value="{{briefs.product}}">
                        </div>
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Çözüm Getiren Sorun"
                                name="product_description" autocomplete="off" value="{{briefs.product_description}}">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <textarea class="form-input" id="" cols="30" rows="10"
                                placeholder="Ürün & Hizmet Özellikleri"
                                name="product_properties">{{briefs.product_properties}}</textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <textarea class="form-input" cols="10" rows="5" placeholder="Ürün & Himzet Avantajları"
                                name="product_advantage">{{briefs.product_advantage}}</textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Vadedilen Kazanımlar" name="gain"
                                autocomplete="off" value="{{briefs.gain}}">
                        </div>
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Yönlendirme Yapılacak Yer"
                                name="redirect_url" autocomplete="off" value="{{briefs.redirect_url}}">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Videoyu izleyenlerden beklenen davranış"
                                name="behaviour" autocomplete="off" value="{{briefs.behaviour}}">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <textarea class="form-input" id="" cols="5" rows="4" placeholder="Genel Konu Özeti"
                                name="summary">{{briefs.summary}}</textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Hedef Kitle" name="target_group"
                                autocomplete="off" value="{{briefs.target_group}}">
                        </div>
                        <div class="col mb-3">
                            <input type="text" class="form-input" placeholder="Şirketin Sektörü" name="company_sector"
                                autocomplete="off" value="{{briefs.company_sector}}">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <select name="target_language" id="" class="form-select">
                                <option>Hikaye Hitap Dili</option>
                                <option value="sen dili" {{selectOption briefs.target_language 'sen dili' }}>Sen Dili
                                </option>
                                <option value="siz dili" {{selectOption briefs.target_language 'siz dili' }}>Siz Dili
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <select class="form-select" aria-label="Default select example" name="text_lenght">
                                <option>Oluşturulacak Metnin Kelime Sayısı</option>
                                <option value="55-60" {{selectOption briefs.text_lenght '55-60' }}> 55 -60</option>
                                <option value="85-90" {{selectOption briefs.text_lenght '85-90' }}>85- 90</option>
                                <option value="110-115" {{selectOption briefs.text_lenght '110-115' }}>110 - 115
                                </option>
                                <option value="170-175" {{selectOption briefs.text_lenght '170-175' }}>170 - 175
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <select name="volume_type" id="" class="form-select">
                                <option>Seslendirme Türü</option>
                                <option value="doğrudan anlatım" {{selectOption briefs.volume_type 'doğrudan anlatım'
                                    }}>Doğrudan Anlatım</option>
                                <option value="hikaye anlatıcılığı" {{selectOption
                                    briefs.volume_type 'hikaye anlatıcılığı' }}>Hikaye Anlatıcılığı</option>
                            </select>

                        </div>
                        <div class="col mb-3">
                            <select name="font" id="" class="form-select">
                                <option>Metin Yazı Tonu</option>
                                <option value="kreatif" {{selectOption briefs.font 'kreatif' }}>Kreatif</option>
                                <option value="klasik ton" {{selectOption briefs.font 'klasik ton' }}>Klasik Ton
                                </option>
                                <option value="agresif" {{selectOption briefs.font 'agresif' }}>Agresif</option>
                            </select>
                        </div>
                    </div>
                    <input type="text" hidden value="{{briefs.id}}" id="id" name="id">
                    <div class="row">
                        <div class="col">
                            <button type="submit" class="btn btn-success w-100" id="create_hook_button">
                                Kanca Cümleler Oluştur
                            </button>
                        </div>
                        <div class="col">
                            <a id="create_scenario_button" class="btn btn-primary w-100">
                                Senaryo Oluştur
                            </a>
                        </div>
                        <div class="col">
                            <a id="update_scenario_button" class="btn btn-warning w-100">
                                Güncelle
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
<!--====== Solutions Section End ======-->

<!-- Modal -->
<div class="modal fade" id="result_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Oluşturulan Anahtar Kelimeler</h5>
                <button type="button" class="close" id="close_modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul id="keyword_list"></ul>
            </div>
            <div class="modal-footer">
                <p class="text-danger text-sm">
                    Veriler otomatik olarak kayıt edilecektir.
                </p>
            </div>
        </div>
    </div>
</div>

{{!-- Hook Centences Modal --}}
<div class="modal fade" id="create_centence_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Kanca Cümleyi Girin</h5>
                <button type="button" class="close" data-bs-dismiss="create_centence_modal" aria-label="Close"
                    id="close_create_centence_modal">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input type="text" class="form-input" placeholder="Kanca Cümle" id="hook_centence">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary btn-sm" id="send_create_scenario_button">Senaryo Oluştur</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="scenario_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Oluşturulan Senaryo</h5>
                <button type="button" class="close" id="close_scenario_button" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body text-center" id="scenario_content">
            </div>
            <div class="modal-footer">
                <p class="text-danger text-sm">
                    Veriler otomatik olarak kayıt edilecektir.
                </p>
            </div>
        </div>
    </div>
</div>



<script>
    $(document).ready(function () {
        $("#scenario_form").submit(function (e) {
            e.preventDefault();
            var button = $(this).find('button[type="submit"]');
            // Butonun içeriğini spinner ile değiştir
            button.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Yükleniyor...');
            // Butonu devre dışı bırak
            button.prop('disabled', true);
            $.ajax({
                url: "/scenario/create",
                type: "POST",
                data: $(this).serialize(),
                success: function (response) {
                    for (const data of response) {
                        var liElement = $('<li>').text(data.message.content.replace('1', '').replace('.', '').replace('"', ''))
                        $('#keyword_list').append(liElement)
                        $('#result_modal').modal('show')
                        $('#scenario_form').trigger("reset");
                    }
                },
                complete: function () {
                    button.html('Gönder');
                    // Butonu etkinleştir
                    button.prop('disabled', false);
                }
            })
        })

        $('#update_scenario_button').on('click', function () {
            var form_data = $('#scenario_form').serialize();
            var id = $('#id').val()
            $.ajax({
                url: '/scenario/briefs/update/' + id,
                type: 'POST',
                data: form_data,
                success: function (response) {
                    window.location.reload()
                }
            })
        })

        $('#create_scenario_button').on('click', function () {
            var form_data = $('#scenario_form').serializeArray();
            $('#create_centence_modal').modal('show')

            $('#send_create_scenario_button').on('click', function () {
                $(this).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Yükleniyor...');
                var hooks_centes = $('#hook_centence').val()
                form_data.push({ name: 'hooks_centes', value: hooks_centes })
                $.ajax({
                    url: '/scenario/add',
                    type: 'POST',
                    data: form_data,
                    success: function (response) {
                        $('#scenario_modal').modal('show')
                        $('#create_centence_modal').modal('hide')
                        var p = $('<p>').html(response[0].message.content)
                        $('#scenario_content').append(p)
                    },
                    complete: function () {
                        $(this).html('Senaryo Oluştur');
                        $(this).prop('disabled', false);
                    }
                })
            })

        })
    })
    $('#close_modal').click(function () {
        $('#keyword_list').empty()
        $('#result_modal').modal('hide')
        window.location.reload()
    })
    $('#close_create_centence_modal').click(function () {
        $('#create_centence_modal').modal('hide')
        window.location.reload()
    })
    $('#close_scenario_button').click(function () {
        $('#scenario_modal').modal('hide')
        window.location.reload()
    })
</script>